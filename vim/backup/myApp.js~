Players = new Mongo.Collection('players'); //runs on both client and server

if (Meteor.isClient) {

    Template.list.rendered = function() {

        var dataSource = new kendo.data.DataSource({
            sort: {
                field: 'score',
                dir: 'desc'
            },
            pageSize: 4
        });

        this.$('#list').kendoListView({
            dataSource: dataSource,
            template: '<tr><td>#:score#</td><td>#:name#</td><td><button class="remove" data-id="#:_id#">X</button></td></tr>'
        });

        this.$('#pager').kendoPager({
            dataSource: dataSource
        });

        this.autorun(function() {
            dataSource.data(Players.find().fetch());
        });
    };

    Template.list.events({
        'click .remove': function(event) {
            Players.remove($(event.target).data('id'));
        }
    });

    Template.addForm.events({
        'submit .addForm': function(event) {

            Players.insert({
                name: event.target.name.value,
                score: Number(event.target.score.value)
            });

            // Clear form
            //             event.target.name.value = '';
            //                         event.target.score.value = '';
            //
            //                                     return false;
            //
            //                                             }
            //                                                 });
            //                                                 }
            //
            //                                                 if (Meteor.isServer) {
            //
            //                                                     Meteor.startup(function() {
            //
            //                                                             if (Players.find().count() === 0) {
            //                                                                         var names = ['Ada Lovelace', 'Grace Hopper', 'Marie Curie', 'Carl Friedrich Gauss'];
            //                                                                                     _.each(names, function(name) {
            //                                                                                                     Players.insert({
            //                                                                                                                         name: name,
            //                                                                                                                                             score: Math.floor(Random.fraction() * 10) * 5
            //                                                                                                                                                             });
            //                                                                                                                                                                         });
            //                                                                                                                                                                                 } 
            //                                                                                                                                                                                     });
            //
            //                                                                                                                                                                                     }
